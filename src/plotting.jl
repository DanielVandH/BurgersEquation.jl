"""
    portrait!(fig, x, y, Z, i, j; xlabel=L"x", ylabel=L"y", nist=true, pltkwargs...)
   
Plots the phase portrait for the data in `Z`, defined over a structured grid.

# Arguments 
- `fig`: A Makie figure object.
- `x`: The real part of the points that `Z` is computed at.
- `y`: The imaginary part of the points that `Z` is computed at.
- `Z`: The matrix of values to plot, defined such that `Z[i, j]` is at `(x[i], y[j])`.
- `i`: The row number to create the axis in `fig`.
- `j`: The column number to create the axis in `fig`.

# Keyword Arguments 
- `xlabel=L"x"`: Label for the x-axis.
- `ylabel=L"y"`: Label for the y-axis.
- `nist = true`: Whether to use the NIST color scheme. If false, the HSV color scheme is used.
- `pltkwargs...`: Extra keyword arguments for `Axis`.

# Output 
There is no output, but `fig` is updated with the figure in `fig[i, j]`.
"""
function portrait!(fig, x, y, Z, i, j; xlabel=L"x", ylabel=L"y", nist=true, pltkwargs...)
    # Phase
    θ = angle.(-Z)
    # Obtain the NIST colormap http://dlmf.nist.gov/help/vrml/aboutcolor) or other
    nc = max(length(x), length(y))
    cm = nist ? ComplexPortraits.nist_colors(nc) : ComplexPortraits.hsv_colors(nc)
    # Make the plot 
    ax = Axis(fig[i, j], xlabel=xlabel, ylabel=ylabel; pltkwargs...)
    heatmap!(ax, x, y, θ, colorrange=(-π, π), colormap=cm)
    return nothing
end

"""
    landscape!(fig, x, y, Z, i, j; <keyword arguments>)
   
Plots the analytical landscape for the data in `Z`, defined over a structured grid.

# Arguments 
- `fig`: A Makie figure object.
- `x`: The real part of the points that `Z` is computed at.
- `y`: The imaginary part of the points that `Z` is computed at.
- `Z`: The matrix of values to plot, defined such that `Z[i, j]` is at `(x[i], y[j])`.
- `i`: The row number to create the axis in `fig`.
- `j`: The column number to create the axis in `fig`.

# Keyword Arguments 
- `xlabel=L"x"`: Label for the x-axis.
- `ylabel=L"y"`: Label for the y-axis.
- `zlabel=L"|u(z, t)|"`: Label for the z-axis.
- `nist = true`: Whether to use the NIST color scheme. If false, the HSV color scheme is used.
- `zlims=(0, maximum(abs.(Z[isfinite.(Z)])))`: `z`-axis limits.
- `pltkwargs...`: Extra keyword arguments for `Axis3`.

# Output 
There is no output, but `fig` is updated with the figure in `fig[i, j]`.
"""
function landscape!(fig, x, y, Z, i, j;
    xlabel=L"x", ylabel=L"y", zlabel=L"|u(z, t)|", nist=true, zlims=(0, maximum(abs.(Z[isfinite.(Z)]))), pltkwargs...)
    # Modulus and phase 
    R = abs.(Z)
    R[R.>zlims[2]] .= zlims[2]
    θ = angle.(-Z)
    # Obtain the NIST colormap http://dlmf.nist.gov/help/vrml/aboutcolor)
    nc = max(length(x), length(y))
    cm = nist ? ComplexPortraits.nist_colors(nc) : ComplexPortraits.hsv_colors(nc)
    # Make the plot 
    ax = Axis3(fig[i, j], xlabel=xlabel, ylabel=ylabel, zlabel=zlabel; pltkwargs...)
    surface!(ax, x, y, R, color=θ, colorrange=(-π, π), colormap=cm, shading=false)
    zlims!(ax, zlims[1], zlims[2])
    return nothing
end


LINSPECER_12 = [
    0.368627450980392 0.309803921568627 0.635294117647059
    0.197386603025884 0.512851710442123 0.740257214831838
    0.353920722469962 0.729472517932409 0.656177840632872
    0.597784406620190 0.840777034550949 0.644490274269565
    0.841701969675001 0.940885130292891 0.609611616709332
    0.931851609124017 0.957193786605551 0.661676168589149
    0.976267475434952 0.928364732010818 0.658313136694680
    0.995493878994122 0.822714483114813 0.482765825462556
    0.987654277338283 0.615414278604657 0.339114037801447
    0.943815034723900 0.390980258870390 0.266846392952373
    0.820562112287474 0.223926402795306 0.309367864350849
    0.619607843137255 0.003921568627451 0.258823529411765
]
LINSPECER_250 = [
    0.368627450980392 0.309803921568627 0.635294117647059
    0.354466005497253 0.318705448920429 0.643410304002283
    0.340956264522221 0.327613349654464 0.651220603793482
    0.328092131661396 0.336527617144218 0.658722730872942
    0.315867510520874 0.345448244763175 0.665914399092951
    0.304276304706754 0.354375225884820 0.672793322305795
    0.293312417825135 0.363308553882638 0.679357214363761
    0.282969753482114 0.372248222130114 0.685603789119136
    0.273242215283789 0.381194224000732 0.691530760424206
    0.264123706836260 0.390146552867979 0.697135842131258
    0.255608131745623 0.399105202105338 0.702416748092580
    0.247689393617977 0.408070165086294 0.707371192160458
    0.240361396059420 0.417041435184333 0.711996888187179
    0.233618042676050 0.426019005772939 0.716291550025029
    0.227453237073966 0.435002870225597 0.720252891526296
    0.221860882859266 0.443993021915793 0.723878626543265
    0.216834883638047 0.452989454217010 0.727166468928225
    0.212369143016408 0.461992160502734 0.730114132533462
    0.208457564600448 0.471001134146450 0.732719331211262
    0.205094051996263 0.480016368521642 0.734979778813913
    0.202272508809953 0.489037857001796 0.736893189193701
    0.199986838647615 0.498065592960396 0.738457276202914
    0.198230945115348 0.507099569770928 0.739669753693837
    0.196998731819250 0.516139780806875 0.740528335518757
    0.196284102365419 0.525186219441724 0.741030735529962
    0.196084535936962 0.534240244199165 0.741172049727233
    0.196803346458958 0.543456280932096 0.740655709549322
    0.198670410253197 0.552916354130066 0.739330109659304
    0.201617608934922 0.562587455951923 0.737265480514929
    0.205576824119381 0.572436578556517 0.734532052573945
    0.210479937421819 0.582430714102695 0.731200056294101
    0.216258830457481 0.592536854749306 0.727339722133148
    0.222845384841612 0.602721992655200 0.723021280548835
    0.230171482189458 0.612953119979223 0.718314961998910
    0.238169004116264 0.623197228880225 0.713290996941123
    0.246769832237276 0.633421311517055 0.708019615833224
    0.255905848167740 0.643592360048561 0.702571049132961
    0.265508933522900 0.653677366633591 0.697015527298084
    0.275510969918003 0.663643323430995 0.691423280786343
    0.285843838968293 0.673457222599620 0.685864540055486
    0.296439422289016 0.683086056298315 0.680409535563262
    0.307229601495418 0.692496816685929 0.675128497767422
    0.318146258202744 0.701656495921310 0.670091657125715
    0.329121274026240 0.710532086163308 0.665369244095889
    0.340086530581150 0.719090579570770 0.661031489135695
    0.350973909482721 0.727298968302544 0.657148622702880
    0.361715292346198 0.735124244517481 0.653790875255196
    0.372242560786826 0.742533400374427 0.651028477250390
    0.382487596419851 0.749493428032232 0.648931659146212
    0.392382280860519 0.755971319649745 0.647570651400412
    0.401874284289359 0.761940378387852 0.646999022335281
    0.411427341600807 0.767586802297060 0.646719650598408
    0.421266265446946 0.773019291192852 0.646471028603423
    0.431368065046318 0.778250432335579 0.646250464557941
    0.441709749617464 0.783292812985592 0.646055266669577
    0.452268328378928 0.788159020403241 0.645882743145949
    0.463020810549252 0.792861641848876 0.645730202194670
    0.473944205346977 0.797413264582847 0.645594952023357
    0.485015521990647 0.801826475865505 0.645474300839625
    0.496211769698804 0.806113862957199 0.645365556851091
    0.507509957689989 0.810288013118281 0.645266028265369
    0.518887095182746 0.814361513609101 0.645173023290076
    0.530320191395617 0.818346951690008 0.645083850132827
    0.541786255547144 0.822256914621353 0.644995817001237
    0.553262296855869 0.826103989663487 0.644906232102923
    0.564725324540335 0.829900764076759 0.644812403645499
    0.576152347819084 0.833659825121521 0.644711639836582
    0.587520375910659 0.837393760058121 0.644601248883788
    0.598806418033601 0.841115156146911 0.644478538994731
    0.609987483406454 0.844836600648241 0.644340818377028
    0.621040581247759 0.848570680822461 0.644185395238293
    0.631942720776059 0.852329983929921 0.644009577786144
    0.642670911209896 0.856127097230972 0.643810674228195
    0.653202161767813 0.859974607985964 0.643585992772063
    0.663513481668351 0.863885103455248 0.643332841625361
    0.673610194585469 0.867879216821226 0.643031788928796
    0.683907884700693 0.872083239850344 0.642426290396930
    0.694511099448333 0.876510390896270 0.641455993033046
    0.705367862641801 0.881126243264028 0.640154661480291
    0.716426198094507 0.885896370258644 0.638556060381814
    0.727634129619864 0.890786345185142 0.636693954380765
    0.738939681031281 0.895761741348546 0.634602108120291
    0.750290876142170 0.900788132053884 0.632314286243541
    0.761635738765942 0.905831090606177 0.629864253393665
    0.772922292716008 0.910856190310453 0.627285774213811
    0.784098561805780 0.915829004471734 0.624612613347127
    0.795112569848668 0.920715106395048 0.621878535436762
    0.805912340658084 0.925480069385417 0.619117305125865
    0.816445898047439 0.930089466747867 0.616362687057585
    0.826661265830143 0.934508871787424 0.613648445875070
    0.836506467819608 0.938703857809111 0.611008346221469
    0.845929527829246 0.942639998117954 0.608476152739931
    0.854878469672466 0.946282866018977 0.606085630073604
    0.863301317162682 0.949598034817205 0.603870542865638
    0.871146094113302 0.952551077817664 0.601864655759180
    0.878360824337739 0.955107568325378 0.600101733397379
    0.884893531649404 0.957233079645371 0.598615540423386
    0.890692239861708 0.958893185082670 0.597439841480346
    0.895704972788061 0.960053457942298 0.596608401211411
    0.899879754241876 0.960679471529280 0.596154984259728
    0.903222967944600 0.960780813548669 0.596166884154884
    0.906243320442209 0.960741795145935 0.597132653285420
    0.909080152590902 0.960660414970396 0.599090374288218
    0.911745325703776 0.960537770735836 0.601950277763073
    0.914250701093927 0.960374960156036 0.605622594309782
    0.916608140074453 0.960173080944781 0.610017554528138
    0.918829503958450 0.959933230815853 0.615045389017938
    0.920926654059015 0.959656507483035 0.620616328378976
    0.922911451689245 0.959344008660110 0.626640603211048
    0.924795758162237 0.958996832060861 0.633028444113949
    0.926591434791087 0.958616075399071 0.639690081687474
    0.928310342888894 0.958202836388522 0.646535746531420
    0.929964343768752 0.957758212742998 0.653475669245580
    0.931565298743761 0.957283302176282 0.660420080429750
    0.933125069127015 0.956779202402156 0.667279210683726
    0.934655516231613 0.956247011134403 0.673963290607303
    0.936168501370651 0.955687826086807 0.680382550800276
    0.937675885857227 0.955102744973150 0.686447221862440
    0.939189531004436 0.954492865507215 0.692067534393590
    0.940721298125375 0.953859285402786 0.697153718993523
    0.942283048533143 0.953203102373644 0.701616006262033
    0.943886643540835 0.952525414133573 0.705364626798915
    0.945543944461549 0.951827318396356 0.708309811203965
    0.947266812608381 0.951109912875776 0.710361790076978
    0.949067109294428 0.950374295285616 0.711430794017749
    0.950961986402792 0.949594594321762 0.711435376521206
    0.952984025022755 0.948612528379809 0.710393760106666
    0.955122205503158 0.947408448394673 0.708372859893581
    0.957358992773520 0.945989944851298 0.705437718611685
    0.959676851763359 0.944364608234628 0.701653378990713
    0.962058247402195 0.942540029029607 0.697084883760398
    0.964485644619548 0.940523797721179 0.691797275650476
    0.966941508344936 0.938323504794287 0.685855597390680
    0.969408303507880 0.935946740733877 0.679324891710745
    0.971868495037898 0.933401096024891 0.672270201340404
    0.974304547864509 0.930694161152274 0.664756569009393
    0.976698926917233 0.927833526600970 0.656849037447445
    0.979034097125589 0.924826782855922 0.648612649384295
    0.981292523419097 0.921681520402074 0.640112447549676
    0.983456670727276 0.918405329724372 0.631413474673324
    0.985509003979644 0.915005801307757 0.622580773484972
    0.987431988105722 0.911490525637176 0.613679386714355
    0.989208088035029 0.907867093197570 0.604774357091207
    0.990819768697083 0.904143094473885 0.595930727345262
    0.992249495021405 0.900326119951065 0.587213540206254
    0.993479731937513 0.896423760114052 0.578687838403919
    0.994492944374927 0.892443605447792 0.570418664667989
    0.995271597263166 0.888393246437228 0.562471061728199
    0.995798155531749 0.884280273567304 0.554910072314284
    0.996055084110196 0.880112277322964 0.547800739155978
    0.996075709942311 0.875814408229672 0.541093526513837
    0.996059209036150 0.871062982969705 0.534359087175483
    0.996028015820686 0.865846394553678 0.527558284041575
    0.995982435115613 0.860190153851120 0.520701444706580
    0.995922771740627 0.854119771731560 0.513798896764962
    0.995849330515423 0.847660759064527 0.506860967811186
    0.995762416259695 0.840838626719549 0.499897985439718
    0.995662333793140 0.833678885566155 0.492920277245022
    0.995549387935452 0.826207046473874 0.485938170821565
    0.995423883506326 0.818448620312234 0.478961993763810
    0.995286125325457 0.810429117950765 0.472002073666224
    0.995136418212540 0.802174050258996 0.465068738123270
    0.994975066987271 0.793708928106454 0.458172314729416
    0.994802376469345 0.785059262362669 0.451323131079125
    0.994618651478456 0.776250563897169 0.444531514766863
    0.994424196834300 0.767308343579484 0.437807793387095
    0.994219317356572 0.758258112279141 0.431162294534286
    0.994004317864967 0.749125380865670 0.424605345802902
    0.993779503179180 0.739935660208600 0.418147274787407
    0.993545178118906 0.730714461177459 0.411798409082267
    0.993301647503840 0.721487294641776 0.405569076281946
    0.993049216153677 0.712279671471079 0.399469603980911
    0.992788188888113 0.703117102534898 0.393510319773626
    0.992518870526843 0.694025098702762 0.387701551254556
    0.992241565889560 0.685029170844198 0.382053626018167
    0.991929330007491 0.676038427785013 0.376473778427420
    0.991505003845815 0.666742657042813 0.370686954327579
    0.990966964696884 0.657149271757398 0.364711904066018
    0.990318641782269 0.647287115019092 0.358586730104624
    0.989563464323539 0.637185029918221 0.352349534905284
    0.988704861542264 0.626871859545111 0.346038420929884
    0.987746262660014 0.616376446990089 0.339691490640310
    0.986691096898359 0.605727635343478 0.333346846498450
    0.985542793478869 0.594954267695605 0.327042590966189
    0.984304781623113 0.584085187136796 0.320816826505415
    0.982980490552660 0.573149236757376 0.314707655578013
    0.981573349489082 0.562175259647670 0.308753180645871
    0.980086787653947 0.551192098898005 0.302991504170875
    0.978524234268826 0.540228597598705 0.297460728614912
    0.976889118555288 0.529313598840098 0.292198956439867
    0.975184869734903 0.518475945712507 0.287244290107628
    0.973414917029241 0.507744481306259 0.282634832080082
    0.971582689659872 0.497148048711680 0.278408684819114
    0.969691616848365 0.486715491019095 0.274603950786611
    0.967745127816290 0.476475651318829 0.271258732444461
    0.965746651785217 0.466457372701209 0.268411132254548
    0.963699617976716 0.456689498256559 0.266099252678761
    0.961607455612356 0.447200871075206 0.264361196178985
    0.959473593913708 0.438020334247475 0.263235065217107
    0.957301462102341 0.429176730863691 0.262758962255014
    0.955003201676178 0.420661590164158 0.262887704885368
    0.952399021500813 0.412399989181949 0.263447292881618
    0.949495954272282 0.404369128644912 0.264396440448197
    0.946306800645571 0.396548210455267 0.265698569221693
    0.942844361275667 0.388916436515232 0.267317100838695
    0.939121436817555 0.381453008727028 0.269215456935792
    0.935150827926222 0.374137128992873 0.271357059149572
    0.930945335256655 0.366947999214987 0.273705329116625
    0.926517759463839 0.359864821295590 0.276223688473540
    0.921880901202762 0.352866797136900 0.278875558856905
    0.917047561128409 0.345933128641138 0.281624361903310
    0.912030539895766 0.339043017710523 0.284433519249343
    0.906842638159821 0.332175666247274 0.287266452531593
    0.901496656575560 0.325310276153611 0.290086583386649
    0.896005395797969 0.318426049331753 0.292857333451100
    0.890381656482033 0.311502187683919 0.295542124361536
    0.884638239282741 0.304517893112330 0.298104377754544
    0.878787944855077 0.297452367519203 0.300507515266713
    0.872843573854029 0.290284812806760 0.302714958534634
    0.866817926934582 0.282994430877219 0.304690129194894
    0.860723804751724 0.275560423632800 0.306396448884082
    0.854574007960440 0.267961992975722 0.307797339238788
    0.848381337215716 0.260178340808205 0.308856221895600
    0.842158593172540 0.252188669032467 0.309536518491108
    0.835918576485897 0.243972179550729 0.309801650661899
    0.829578652399038 0.235566735427512 0.309734850187769
    0.823007961355495 0.227050341180985 0.309496543420228
    0.816210441925823 0.218425067032813 0.309088909312063
    0.809191198067706 0.209692295961244 0.308512709912511
    0.801955333738830 0.200853410944522 0.307768707270812
    0.794507952896881 0.191909794960895 0.306857663436202
    0.786854159499544 0.182862830988609 0.305780340457918
    0.778999057504503 0.173713902005910 0.304537500385200
    0.770947750869444 0.164464390991044 0.303129905267284
    0.762705343552053 0.155115680922257 0.301558317153409
    0.754276939510015 0.145669154777796 0.299823498092811
    0.745667642701014 0.136126195535907 0.297926210134729
    0.736882557082737 0.126488186174837 0.295867215328401
    0.727926786612868 0.116756509672831 0.293647275723064
    0.718805435249092 0.106932549008136 0.291267153367956
    0.709523606949096 0.097017687158998 0.288727610312314
    0.700086405670564 0.087013307103663 0.286029408605377
    0.690498935371182 0.076920791820377 0.283173310296382
    0.680766300008634 0.066741524287387 0.280160077434566
    0.670893603540607 0.056476887482940 0.276990472069169
    0.660885949924785 0.046128264385281 0.273665256249426
    0.650748443118853 0.035697037972656 0.270185192024577
    0.640486187080497 0.025184591223312 0.266551041443859
    0.630104285767403 0.014592307115495 0.262763566556509
    0.619607843137255 0.003921568627451 0.258823529411765
]
const LINSPECER_12_J = ColorScheme([RGB{Float64}(rgb[1], rgb[2], rgb[3]) for rgb in eachrow(LINSPECER_12)])
const LINSPECER_250_J = ColorScheme([RGB{Float64}(rgb[1], rgb[2], rgb[3]) for rgb in eachrow(LINSPECER_250)])
